---
layout: post
title: '简单的VIM配置'
date: 2015-03-05
author: wuxiangwei
categories: 工具 Vim
tags: 工具 Vim
---
<br>

* Kramdown table of content
{:toc, toc}

## 快捷键

### 基础


gg     
G    
/   
?    
vimgrep    
copen    
c-n    
c-p    
fx    

dd    
dw    
dl    

i    
I    
a    
A    


查看`runtimepath`的路径：`:set runtimepath?`    
如果vim不支持选中即复制，执行`sudo apt-get install vim-gtk`命令    

### 窗口间移动光标

ctrl + w + k/j/h/l

j向下


上下左右


移动到前一个访问的窗口： ctrl + w + p，代码窗口和quickfix窗口是高频访问切换的窗口。

在所有窗口中移动： ctrl + w + w

## 私有工具管理

一台服务器有多人使用，自己想使用自己的专用工具，例如vim，系统的版本比较低，自己编译一个新版本。
在自己的目录下新建.myenv文件，添加环境变量修改，例如：

```
export PATH=/home/wuxiangwei/mytools/vim-v7.4.2220/bin:$PATH
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/mytools/clang+llvm-5.0.0-x86_64-linux-gnu-debian8/lib
```
然后在.bashrc或者.zshrc文件末尾添加`source ~/.myenv`，连接控制台时自动初始化这些环境变量。


## 书签

### 打书签 m{a-zA-Z}
### 删书签 :delma
### 跳转到书签 `{a-zA-Z}


## 插件

### Tagbar

说明：

1. 标签已排序，不是tag在正文中出现的顺序；
2. 配置了跳转到正文时关闭tagbar的功能；
3. 管理精力，在tagbar中**预览**整体，在正文窗口聚焦某个子标题。

#### 折叠

全部折叠 z + M

全部展开 z + R

单个折叠 z + c (close)

单个展开 z + o (open)

#### 预览

p

不离开tagbar窗口

#### jump

回车，跳转到代码窗口

#### 大窗口

x

#### 退出

q

#### quickfix的影响

使用:cw打开quickfix，在有垂直分割窗口的情况下，quickfix窗口会出现在最右侧窗口的底部。
改用:bo cw打开quickfix，quickfix窗口会出现在整个窗口的底部。

#### leaderf的影响

光标在tagbar窗口时执行leaderf命令，leaderf会将文件在tagbar窗口打开。为减少影响，取消autofocus配置。


### cscope

搜索符号或字符串有两种场景，一种是光标就近搜索，另一种是光标不在待查找字符。第一种使用快捷键，第二种使用`:cs f s`。

#### 准备工作

```shell
find fullpath -name "*.cc" -o -name "*.h" -o -name "*.c" -o -name "*.hpp" > cscope.files
cscope -bkq -i cscope.files
ctags -R
```

修改环境变量：CSCOPE_DB


#### cs f s

Ctrl + \ + s


#### cs f t

Ctrl + \ + t

#### cs f g

转到函数定义的地方

Ctrl + \ +g

#### cs f c

调用该函数的地方

Ctrl + \ +c

### Surround

命令模式：原生命令 + s + text-object

text-object

i 和 a：    

`i` inner object 选中一个object的内部，不包括空格；    
`a` an object 选中一个object，包括空格在内；    

aw a word    
iw inner word     

aw 和 iw的区别：

```
a word

1. a a a a a 
2. aaaaa
```
假设光标在a中，yawppppp 的结果为1，yiwppppp的结果为2

w word字    
p paragraph段落     
s sentence    


d s aw    
y s aw    
c s aw    


Shift + ]    
Shift + [    
Shift + #    
Shift + *    


### ctags插件

**配置**

set tags=tags;    
set autochdir    

在源码目录执行 `ctags -R` 命令。    

**快捷键**


ctrl + ]  
g ctrl + ]  

### Nerdtree

使用vim-nerdtree-tab插件，在新标签中显示同样的nerdtree窗口。

#### p 切换到父目录
#### t 新标签中打开
#### K 本目前第一个文件

和小k的方向一致，向上，只是向上到头。

#### J 本目录最后一个文件

和小j的方向一致，向下，只是向下到尾。

### YouCompleteMe

#### 编译安装

cd到YCM目录，执行build.sh脚本。

安装YCM时，如果不指定--clang-completer选项，Vim敲指针`->`时会卡住，并且没有补全。

对Linux环境，编译过程中下载clang的速度很慢，可以先下载预编译好的，然后在build.sh中使用--system-libclang选项，不过前提条件是：

```
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/mytools/clang+llvm-5.0.0-x86_64-linux-gnu-debian8/lib
```

错误1：

```
[100%] Linking CXX shared library /Users/wuxiangwei/.vim/bundle/YouCompleteMe/third_party/ycmd/ycm_core.so
ld: can't write output file: /Users/wuxiangwei/.vim/bundle/YouCompleteMe/third_party/ycmd/ycm_core.so for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [/Users/wuxiangwei/.vim/bundle/YouCompleteMe/third_party/ycmd/ycm_core.so] Error 1
```
执行`./install.py --clang-completer`命令报上述错误，权限问题，命令前添加sudo即可。


错误2：

```
NoExtraConfDetected: No .ycm_extra_conf.py file detected, so no compile flags are available. Thus no semantic support for C/C++/ObjC/ObjC++. Go READ THE DOCS *NOW*,
```
在`.vimrc`文件中添加.ycm_extra_conf.py路径。


## 附件

1. (.vimrc文件)[https://github.com/wuxiangwei/toolkit/blob/master/src/vim/.vimrc]

